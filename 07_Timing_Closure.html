<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timing Closure | PD Blog</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="header">
        <div class="header-content">
            <h1><a href="index.html">ğŸ”§ Physical Design Blog</a></h1>
            <div class="nav-links">
                <a href="index.html">Home</a>
                <a href="06_Routing.html">â† Prev</a>
                <a href="08_Physical_Verification.html">Next â†’</a>
            </div>
        </div>
    </div>
    
    <div class="container">
        <div class="article-header">
            <span class="article-number">Part 7 of 10</span>
            <h1>Timing Closure</h1>
            <p class="subtitle">Meeting timing requirements across all corners</p>
            <p class="author">By <strong>Praveen Kumar Vagala</strong></p>
            <div class="view-counter">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
                <span class="view-count">1,143</span> views
            </div>
        </div>

        <h2>What is Timing Closure?</h2>
        <p>Timing closure means all timing requirements are met - no setup or hold violations.</p>

<div class="diagram">                    Timing Report

Startpoint: reg_A/Q
Endpoint:   reg_B/D
Path Type:  max (setup)

Point                      Delay   Path
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
clock clk (rise)           0.000   0.000
reg_A/CK                   0.500   0.500  (clock latency)
reg_A/Q                    0.150   0.650  (Tcq)
U1/Y (AND2)                0.080   0.730
U2/Y (OR2)                 0.095   0.825
U3/Y (BUF)                 0.060   0.885
reg_B/D (setup)            0.050   0.935
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Data Arrival Time                  0.935

Clock clk (rise)           1.000   1.000  (period)
reg_B/CK                   0.480   1.480  (clock latency)
library setup time        -0.050   1.430
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Data Required Time                 1.430

Slack = 1.430 - 0.935 = 0.495ns (MET) âœ“</div>

        <h2>Key Timing Terms</h2>
        <table>
            <tr><th>Term</th><th>Definition</th></tr>
            <tr><td>WNS</td><td>Worst Negative Slack - worst path</td></tr>
            <tr><td>TNS</td><td>Total Negative Slack - sum of all violations</td></tr>
            <tr><td>Slack</td><td>Required time - Arrival time (positive = good)</td></tr>
            <tr><td>Setup</td><td>Data must be stable before clock edge</td></tr>
            <tr><td>Hold</td><td>Data must be stable after clock edge</td></tr>
        </table>

        <h2>PVT Corners</h2>
        <p>Design must work across all Process, Voltage, Temperature conditions.</p>

        <table>
            <tr><th>Corner</th><th>Process</th><th>Voltage</th><th>Temp</th><th>Used For</th></tr>
            <tr><td>Worst Setup (SS)</td><td>Slow</td><td>Low</td><td>High</td><td>Setup analysis</td></tr>
            <tr><td>Best Hold (FF)</td><td>Fast</td><td>High</td><td>Low</td><td>Hold analysis</td></tr>
            <tr><td>Typical (TT)</td><td>Typical</td><td>Nominal</td><td>25Â°C</td><td>Reference</td></tr>
        </table>

        <h2>Setup Violations</h2>
        <p>Data arrives TOO LATE (after setup window).</p>

<div class="diagram">Problem:
    Path is too slow, data misses clock edge
    
    reg_A â”€â”€â–º Long path (slow) â”€â”€â–º reg_B
                                     â”‚
                         Data arrives late!

Solutions:
1. Upsize cells (faster)
2. Add buffers (reduce load)
3. Reduce wire length (better placement)
4. Use parallel paths
5. Lower clock frequency</div>

        <h3>Fixing Setup Violations</h3>
<pre><code># Upsize a cell
ecoChangeCell -inst U1 -cell AND2_X4  # X1 â†’ X4

# Add buffer to reduce fanout
ecoAddRepeater -net slow_net -cell BUF_X4

# Optimize automatically
optDesign -postRoute -setup</code></pre>

        <h2>Hold Violations</h2>
        <p>Data arrives TOO FAST (before hold window ends).</p>

<div class="diagram">Problem:
    Path is too fast, data changes too quickly
    
    reg_A â”€â”€â–º Short path (fast) â”€â”€â–º reg_B
                                     â”‚
                    Data changes before hold ends!

Solutions:
1. Add delay buffers
2. Downsize cells (slower)
3. Increase wire length (rarely)
4. CANNOT change clock frequency!</div>

        <h3>Fixing Hold Violations</h3>
<pre><code># Add delay buffer
ecoAddRepeater -net fast_net -cell DELAY_X1

# Optimize automatically
optDesign -postRoute -hold

# Check hold after fixing
timeDesign -postRoute -hold</code></pre>

        <h2>Optimization Techniques</h2>
        <table>
            <tr><th>Technique</th><th>For Setup</th><th>For Hold</th></tr>
            <tr><td>Cell sizing</td><td>Upsize â†‘</td><td>Downsize â†“</td></tr>
            <tr><td>Buffer insertion</td><td>Reduce load</td><td>Add delay</td></tr>
            <tr><td>Vt swapping</td><td>Use LVT</td><td>Use HVT</td></tr>
            <tr><td>Wire optimization</td><td>Shorten wires</td><td>Longer wires (rare)</td></tr>
            <tr><td>Logic restructuring</td><td>Parallel paths</td><td>N/A</td></tr>
        </table>

        <h2>Useful Skew</h2>
        <p>Intentionally delay clock to help setup timing.</p>

<div class="diagram">Before useful skew:
    CLKâ”€â”¬â”€â–º FF_A â”€â”€â”€(slow path)â”€â”€â”€â–º FF_B  SETUP VIOLATION!
        â”‚                             â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    CLK arrives same time

After useful skew:
    CLKâ”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º FF_A â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                              â”‚
        â””â”€â”€ BUF â”€â–º FF_B â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
            CLK delayed at FF_B
            More time for data!</div>

        <h2>Multi-Corner Multi-Mode (MCMM)</h2>
        <p>Analyze timing across multiple scenarios simultaneously.</p>

<pre><code># Define corners
create_timing_condition tc_slow -library slow.lib
create_timing_condition tc_fast -library fast.lib

# Define modes
create_mode func_mode -sdc func.sdc
create_mode test_mode -sdc test.sdc

# Create analysis views
create_analysis_view view_slow_func \
  -timing_condition tc_slow \
  -mode func_mode

# Run MCMM analysis
timeDesign -postRoute</code></pre>

        <h2>Timing ECO (Engineering Change Order)</h2>
        <p>Small fixes after routing is complete.</p>

<pre><code># Manual cell swap
ecoChangeCell -inst U1 -cell BUF_X8

# Add buffer
ecoAddRepeater -term U2/A -cell BUF_X2

# Remove cell
ecoDeleteRepeater -inst BUF1

# Legalize after ECO
ecoPlace

# Route ECO changes
ecoRoute</code></pre>

        <h2>Timing Closure Flow</h2>

<div class="diagram">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Run initial timing analysis                               â”‚
â”‚    timeDesign -postRoute -reportOnly                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. Fix setup violations first                                â”‚
â”‚    optDesign -postRoute -setup                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3. Fix hold violations                                       â”‚
â”‚    optDesign -postRoute -hold                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 4. Re-check timing                                           â”‚
â”‚    timeDesign -postRoute                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 5. Iterate until clean                                       â”‚
â”‚    WNS = 0, TNS = 0, No hold violations                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</div>

        <h2>Timing Reports</h2>
<pre><code># Summary report
report_timing -summary

# Worst paths
report_timing -nworst 10

# Hold report
report_timing -delay_type min

# Check specific path
report_timing -from reg_A/Q -to reg_B/D

# All violating paths
report_timing -max_slack 0</code></pre>

        <div class="summary">
            <h3>Summary</h3>
            <table>
                <tr><th>Concept</th><th>Key Point</th></tr>
                <tr><td>Setup</td><td>Data arrives before clock</td></tr>
                <tr><td>Hold</td><td>Data stable after clock</td></tr>
                <tr><td>WNS</td><td>Worst single violation</td></tr>
                <tr><td>TNS</td><td>Total of all violations</td></tr>
                <tr><td>Corners</td><td>SS for setup, FF for hold</td></tr>
            </table>
        </div>

        <div class="nav-buttons">
            <a href="06_Routing.html" class="nav-btn prev">â† Routing</a>
            <a href="08_Physical_Verification.html" class="nav-btn next">Physical Verification â†’</a>
        </div>
    </div>
    
    <div class="footer">
        <p>Physical Design Blog Series | Part 7 of 10</p>
    </div>
</body>
</html>
