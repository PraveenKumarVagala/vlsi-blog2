<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Routing | PD Blog</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="header">
        <div class="header-content">
            <h1><a href="index.html">ğŸ”§ Physical Design Blog</a></h1>
            <div class="nav-links">
                <a href="index.html">Home</a>
                <a href="05_Clock_Tree_Synthesis.html">â† Prev</a>
                <a href="07_Timing_Closure.html">Next â†’</a>
            </div>
        </div>
    </div>
    
    <div class="container">
        <div class="article-header">
            <span class="article-number">Part 6 of 10</span>
            <h1>Routing</h1>
            <p class="subtitle">Connecting all the signals with metal wires</p>
            <p class="author">By <strong>Praveen Kumar Vagala</strong></p>
            <div class="view-counter">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
                <span class="view-count">1,067</span> views
            </div>
        </div>

        <h2>What is Routing?</h2>
        <p>Routing creates metal connections between cell pins according to the netlist.</p>

<div class="diagram">Before Routing:              After Routing:

â”Œâ”€â”€â”€â”         â”Œâ”€â”€â”€â”          â”Œâ”€â”€â”€â”â•â•â•â•â•â•â•â•â•â”Œâ”€â”€â”€â”
â”‚ A â”‚    â†’    â”‚ B â”‚          â”‚ A â”‚         â”‚ B â”‚
â””â”€â”¬â”€â”˜         â””â”€â”€â”€â”˜          â””â”€â”¬â”€â”˜    â•‘    â””â”€â”¬â”€â”˜
  â”‚                            â”‚      â•‘      â”‚
  â”‚           â”Œâ”€â”€â”€â”            â• â•â•â•â•â•â•â•      â”‚
  â””â”€â”€â†’        â”‚ C â”‚            â•‘             â”‚
              â””â”€â”€â”€â”˜            â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•
                               â”‚      via    â”‚
                             â”Œâ”€â”´â”€â”         â”Œâ”€â”´â”€â”
                             â”‚ C â”‚         â”‚ C â”‚
                             â””â”€â”€â”€â”˜         â””â”€â”€â”€â”˜
                             
Logical connections       Physical metal wires</div>

        <h2>Routing Stages</h2>

<div class="diagram">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. GLOBAL ROUTING (Track Assignment)                        â”‚
â”‚    â€¢ Divide chip into regions (GCells)                      â”‚
â”‚    â€¢ Plan rough paths through regions                       â”‚
â”‚    â€¢ No actual wires yet                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. DETAIL ROUTING                                           â”‚
â”‚    â€¢ Create actual metal geometries                         â”‚
â”‚    â€¢ Follow DRC rules (width, spacing)                      â”‚
â”‚    â€¢ Insert vias at layer changes                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3. SEARCH & REPAIR (DRC Fixing)                             â”‚
â”‚    â€¢ Find and fix DRC violations                            â”‚
â”‚    â€¢ Reroute problematic areas                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</div>

        <h2>Metal Layers</h2>
        <p>Different layers for different purposes:</p>

<div class="diagram">              Usage              Direction
              
M10-M12   â•â•â•  Power (thick)      Horizontal
M7-M9     â•â•â•  Semi-global        Mixed
M5-M6     â•‘â•‘â•‘  Signal routing     Alternating
M3-M4     â•â•â•  Signal routing     Alternating
M1-M2     â•‘â•‘â•‘  Local connections  Alternating
          
Odd layers: Horizontal (M1, M3, M5...)
Even layers: Vertical (M2, M4, M6...)

(Convention varies by foundry)</div>

        <h2>Routing Grid and Tracks</h2>

<div class="diagram">    Track 1  Track 2  Track 3  Track 4
       â”‚        â”‚        â”‚        â”‚
    â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€  M3
       â”‚        â”‚        â”‚        â”‚
       â”‚    â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•ªâ•â•â•â•    â”‚     Wire on M3
       â”‚        â”‚        â”‚        â”‚
    â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€
       â”‚        â”‚        â”‚        â”‚
       â•‘        â•‘        â•‘        â•‘     M2 (vertical)
       â”‚        â”‚        â”‚        â”‚
       â”‚        â”‚   Via  â”‚        â”‚
    â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â•³â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€  M1
       â”‚        â”‚        â”‚        â”‚

Wires follow tracks (routing grid)
Vias connect layers</div>

        <h2>Via Structure</h2>

<div class="diagram">Cross-section:              Top view:

    â•â•â•â•â•â•â•â•â•â• M3            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”ƒâ”ƒâ”ƒ                   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”‚
    â•â•â•â•â•â•â•â•â•â• M2            â”‚ â”‚ Via  â”‚ â”‚ M2
       â”ƒâ”ƒâ”ƒ                   â”‚ â”‚Array â”‚ â”‚
    â•â•â•â•â•â•â•â•â•â• M1            â”‚ â””â”€â”€â”€â”€â”€â”€â”˜ â”‚
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Via stack connects               M1
multiple layers</div>

        <h2>Design Rule Check (DRC) in Routing</h2>
        <table>
            <tr><th>Rule</th><th>Description</th></tr>
            <tr><td>Minimum width</td><td>Wire can't be too thin</td></tr>
            <tr><td>Minimum spacing</td><td>Wires must be apart</td></tr>
            <tr><td>Via enclosure</td><td>Metal must surround via</td></tr>
            <tr><td>End-of-line</td><td>Extra spacing at wire ends</td></tr>
            <tr><td>Min area</td><td>Metal shapes need minimum area</td></tr>
        </table>

        <h2>Routing Challenges</h2>

        <h3>Congestion</h3>
<div class="diagram">GCell overflow:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    4 tracks      â”‚    4 tracks        â”‚
â”‚    available     â”‚    available       â”‚
â”‚                  â”‚                    â”‚
â”‚    6 nets need   â”‚    2 nets need     â”‚
â”‚    to cross!     â”‚    to cross        â”‚
â”‚                  â”‚                    â”‚
â”‚   OVERFLOW!      â”‚    OK              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Solutions:
- Spread cells in placement
- Use more routing layers
- Increase GCell density</div>

        <h3>Antenna Effect</h3>
        <p>Long metal wires can damage gates during manufacturing.</p>

<div class="diagram">During manufacturing, plasma etches metal.
Long wire collects charge â†’ damages thin gate oxide.

    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–º Long wire
                                      â”‚
                                   â”Œâ”€â”€â”´â”€â”€â”
                                   â”‚Gate â”‚ â† Damaged!
                                   â””â”€â”€â”€â”€â”€â”˜

Fix: Add antenna diodes or break wire with layer changes.</div>

        <h2>Signal Integrity</h2>

        <h3>Crosstalk</h3>
<div class="diagram">Victim net:    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
               â†‘ coupling â†‘
Aggressor:     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–º

When aggressor switches:
- Victim signal gets noise (glitch)
- Victim timing changes (delay)

Fix: Space wires, use shielding, different layers</div>

        <h2>Routing Commands (Innovus)</h2>
<pre><code># Set routing options
setRouteMode -earlyGlobalHonorMsvRouteConstraint false
setRouteMode -timing true

# Global route
route_global

# Detail route
route_detail

# Or combined:
routeDesign

# Fix DRC violations
routeDesign -wireOpt

# ECO routing (incremental)
ecoRoute

# Check routing
verifyConnectivity
verify_drc</code></pre>

        <h2>Route Optimization</h2>
<pre><code># Post-route optimization
optDesign -postRoute

# Fix timing with routing
setOptMode -postRouteAllowOverlaps false
optDesign -postRoute -hold

# Fix SI (crosstalk)
optDesign -postRoute -si</code></pre>

        <h2>Routing Quality Checks</h2>
        <table>
            <tr><th>Check</th><th>What to Look For</th></tr>
            <tr><td>DRC violations</td><td>Should be 0</td></tr>
            <tr><td>Shorts</td><td>Should be 0</td></tr>
            <tr><td>Opens</td><td>Should be 0</td></tr>
            <tr><td>Antenna violations</td><td>Should be 0</td></tr>
            <tr><td>Congestion overflow</td><td>Should be 0</td></tr>
        </table>

        <div class="summary">
            <h3>Summary</h3>
            <table>
                <tr><th>Stage</th><th>Key Point</th></tr>
                <tr><td>Global routing</td><td>Plan paths, no actual wires</td></tr>
                <tr><td>Detail routing</td><td>Create actual metal geometries</td></tr>
                <tr><td>DRC fixing</td><td>Search and repair violations</td></tr>
                <tr><td>Antenna</td><td>Add diodes for long wires</td></tr>
                <tr><td>Crosstalk</td><td>SI optimization needed</td></tr>
            </table>
        </div>

        <div class="nav-buttons">
            <a href="05_Clock_Tree_Synthesis.html" class="nav-btn prev">â† Clock Tree Synthesis</a>
            <a href="07_Timing_Closure.html" class="nav-btn next">Timing Closure â†’</a>
        </div>
    </div>
    
    <div class="footer">
        <p>Physical Design Blog Series | Part 6 of 10</p>
    </div>
</body>
</html>
